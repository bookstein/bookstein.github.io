
<!DOCTYPE HTML>
<html>
<head>
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>A blog for a Bookstein  | Emily Blogstein</title>

<meta name="author" content="Emily Bookstein"> 

<meta name="description" content="Image: The Guardian According to Greek legend, Cassandra was a prophet. She foresaw terrible, tragic futures — but as if that wasn’t enough, she was &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Emily Blogstein" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
</head>



<body>
	<header id="header" class="inner"><h1><a href="/">Emily Blogstein</a></h1>
<h4>A blog for a Bookstein</h4>
<nav id="main-nav"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/stuff">Stuff</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/stuff">Stuff</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:bookstein.github.io">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/09/09/the-legend-of-cassandra/">
		
			The Legend of Cassandra</a>
	</h2>
	<div class="entry-content">
		<p><img class="[Cassandra]" src="/images/cassandra.jpeg" width="620" height="372" title="[Cassandra [painting of Cassandra]]" ></p>

<h6>Image: <a href="https://www.theguardian.com/world/2015/jan/26/alexis-tsiprass-victory-speech-cassandra-myth-greek-elections">The Guardian</a></h6>

<p>According to Greek legend, Cassandra was a prophet. She foresaw terrible, tragic futures — but as if that wasn’t enough, she was also cursed to never be believed.</p>

<p>I had always wondered why on earth <a href="http://planetcassandra.org">Apache Cassandra</a> was named after a prophet who was never believed. Doesn’t give you the greatest confidence in their software, no?</p>

<p>But yesterday, I learned a ton about Cassandra from a knowledgeable coworker — and now, the reference to Greek legend makes sense.</p>

<h2>What is Cassandra?</h2>

<p>Cassandra is a distributed data management system built for handling large volumes of I/O with no single point of failure. With Cassandra, your database is just a file system, with files spread out over a number of nodes that are arranged in a cluster.</p>

<p><img class="[Cassandra]" src="/images/cassandra-ring.png" width="219" height="215" title="[Cassandra ring [Cassandra ring]]" ></p>

<h6>Image: PlanetCassandra.org</h6>

<h2>How is it different from MySQL?</h2>

<p>Relational databases like MySQL and Postgres use a binary tree structure to store information. Binary trees are great for reading information quickly — they&rsquo;re a data structure that accommodates binary search, dividing predictable/sortable information in half and search the new half for the desired row. However, adding new rows to a binary tree is kind of ugly. You add the new information as randomly-inserted leaf nodes in the tree and now your binary tree is out of order.</p>

<p>Cassandra solves this problem by getting rid of the binary tree and replacing it with a token ring. In a token ring, you start with a key (like “start time” or “id”) and generate a unique hashed key, an unsigned <code>Long</code> with a value somewhere between -2<sup>64</sup> and 2<sup>63</sup>. The ring is divided into chunks, each of which have a node assigned to it. For example, you might have a chunk of hashed keys assigned to Node 1, another chunk to Node 3, another chunk to Node 2, another chunk to Node 1, another chunk to Node 3, etc. The chunks are distributed in a somewhat random way to try to fairly balance the load — you wouldn’t want a bunch of traffic going to Node 1 and overwhelming it with requests.</p>

<p>But, just like the prophet from Greek legend, never believe Cassandra.</p>

<h2>Can’t trust Cassandra</h2>

<p>Any one node by itself can’t be trusted. In fact, the token ring doesn’t just assign one node to each chunk of hash keys, but a list of nodes in the order in which to try to write the data. For example: chunk 256 => [2,3,1]. This will try to write to Node 2 first, then 3, then 1. The data will be stored on multiple nodes eventually.</p>

<p>Every cluster has a replication factor, a value that determines how many nodes to repeat the data on. For example, if our 3-node cluster has a replication factor (RF) of 3, then data will be stored on all 3 of the nodes. My coworker strongly believes that 3 is the minimum sensible RF — because if any of your nodes ever goes down, then you’d rely on a backup node, and you’d need 1 more node to double-check to verify the data is good. (3 nodes - 1 node = 2 nodes. 1 node for requesting the data, 1 to double-check that the first one is right.)</p>

<p><img class="[Cassandra nodes]" src="/images/nodes.png" width="662" height="482" title="[Cassandra nodes [Cassandra nodes]]" ></p>

<h6>Image: <a href="https://www.hakkalabs.co/articles/how-cassandra-stores-data">HakkaLabs</a></h6>

<h2>Scalable system</h2>

<p>One thing that’s amazing about Cassandra is how easy it is to add a new node and therefore add capacity to a cluster. You add the provisioned server to the cluster by simply starting Cassandra on the server (it’s a Java app), then adding its IP address to the list of known nodes. The Cassandra node gets the schema information from the “seed” nodes (the seed nodes are just the nodes, listed by IP address, found in the Cassandra config under “seeds”), the token ring breaks and re-forms to include the new node, and the new node begins streaming data from older nodes. Once it’s joined the cluster and owns all the information it’s expected to own, then it’s ready to receive traffic, and you’ve just added a terabyte of available storage space to your database.</p>

<p>There are no masters, there are no replicas. Just nodes.</p>

<p>It’s a cool system. The co-op nerd side of me loves the hierarchy-free model based on negotiation, shared ownership, and consent among nodes.</p>

<p>However, there are some serious drawbacks to using Cassandra.</p>

<h2>What’s wrong with Cassandra?</h2>

<p>The biggest downside of Cassandra that has come up so far in conversation: it was designed to solve the problem of slow writes. When MySQL or Postgres write something new to a binary tree, that information gets spread out over the binary tree &ndash; it&rsquo;s not all in one place. Cassandra, on the other hand, writes new information all together. This is convenient when your model of storage is a spinning hard disk drive, where you&rsquo;d want all the writes to be together.</p>

<p>But with the advent of solid-state drives, this problem might feel a little irrelevant. And given that Cassandra requires a lot of specialized knowledge outside the comfort zone of people who understand SQL really well, there might not be enough of an incentive to make the switch &ndash; or to even stop using Cassandra after having started.</p>

<hr />

<h4>Sources:</h4>

<ul>
<li><a href="http://www.planetcassandra.org/what-is-apache-cassandra/">http://www.planetcassandra.org/what-is-apache-cassandra/</a></li>
<li><a href="https://www.hakkalabs.co/articles/how-cassandra-stores-data">https://www.hakkalabs.co/articles/how-cassandra-stores-data</a></li>
<li>My awesome coworker</li>
</ul>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-09-09T04:58:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/cassandra/'>cassandra</a>, <a class='category' href='/blog/categories/database/'>database</a>, <a class='category' href='/blog/categories/operations/'>operations</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/08/24/going-deeper-with-dns/">
		
			Going Deeper With DNS</a>
	</h2>
	<div class="entry-content">
		<p>Sometimes you just need to say things out loud to someone else to know that you understand something. That&rsquo;s what I did with my coworker the other day &ndash; just described out loud to him how I thought our internal service worked. It really helped. I got to put my vague thoughts into words, and he offered corrections as needed.</p>

<p>Turns out that, like most things, our service works because of the magic that is the Internet. HTTP requests, DNS lookup, IP addresses, CORS, etc, are all at the core of how it functions. Trying to explain how the service worked reminded me of the code interview prep question I practiced when I was trying to get my first software job: &ldquo;Explain how the Internet works at a high level.&rdquo;</p>

<h3>The /etc/hosts hack</h3>

<p>DNS (Domain Name System) lookup is hierarchical. When you make a request for a domain like google.com, the request will travel up through a series of DNS servers until it finds an entry for google.com that points to a specific IP address.</p>

<p>From your laptop, the very first place your computer looks in that hierarchy chain is a file called <code>/etc/hosts</code>. It contains a list of domain names and IP addresses, just like any other DNS server. And so, if you put an entry like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>127.0.0.1   www.google.com</span></code></pre></td></tr></table></div></figure>


<p>then from now on, when you try to load google.com in your browser (unless your browser has a cached version), you will actually be directed to 127.0.0.1 &ndash; your own machine.</p>

<p>This is useful if you want to simulate, say, hitting an internal service that proxies your request to another app. Put the IP address of the internal service with the name of your app in your <code>/etc/hosts</code> file, and your computer will map the domain of the app to the real live internal service, located at that IP address, that receives the request and proxies it elsewhere.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># the internal service IP        the app
</span><span class='line'>55.5.555.55                      mycoolapp.mydomain.com</span></code></pre></td></tr></table></div></figure>


<h3>Who controls DNS?</h3>

<p>So besides just putting it in your <code>/etc/hosts</code> file, how do IP addresses end up with registered domain names?</p>

<p>when you buy a domain (like from Namecheap or Godaddy), those vendors work with <a href="http://www.iana.org/">IANA</a> to add your DNS entry &ndash; that&rsquo;s the department of <a href="https://en.wikipedia.org/wiki/ICANN">ICANN</a> that controls IP/DNS stuff. Yes, deep down in there, there&rsquo;s a bureaucracy (no offense, IANA) sitting inside the Internet, pulling the strings.</p>

<p>Companies may have their own DNS servers, too. Internal apps and services that don&rsquo;t need to be accessed by the public Internet can have IP addresses that don&rsquo;t need to be registered through IANA.</p>

<h3>Domain Name VS. Host VS. IP</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>55.5.555.55     mydata.com        # domain name
</span><span class='line'>55.5.555.55     wwww.mydata.com   # sub-domain</span></code></pre></td></tr></table></div></figure>


<p>It used to be the case that subdomains usually had their own unique IP address. Then we learned about <em>Reduce, Reuse, Recycle</em>. Now, it&rsquo;s common for any one IP address to have many subdomains. So how do we know where exactly to send the request?</p>

<p>Every HTTP request comes with a <code>Host</code> header. The Host header identifies the location &ndash; the actual host machine &ndash; to where we&rsquo;re sending packets. The host is the domain name of the server (as well as the port if a nonstandard port is being used). Getting close to the metal here!</p>

<p>Knowing the hostname and port, we can now send the request to the correct host at the IP address we looked up.</p>

<h3>In Summary: A Midsummer Night&rsquo;s Dream</h3>

<p><img class="[Thisbe]" src="/images/271px-John_William_Waterhouse_-_Thisbe,_1909.jpg" width="271" height="480" title="[Thisbe [painting of Thisbe]]" ></p>

<h6>Image: John William Waterhouse - Art Renewal Center – description, Public Domain, <a href="https://commons.wikimedia.org/w/index.php?curid=39913701">https://commons.wikimedia.org/w/index.php?curid=39913701</a></h6>

<p>Let&rsquo;s say you&rsquo;re making an internal service who receives requests from one lover, inserts some headers into the request, and proxies the request to its ultimate destination &ndash; then hands back the response. A go-between romantic messenger service.</p>

<p>Let&rsquo;s pull in some Shakespeare: your service is Wall, and your lovers are Pyramus and Thisbe.</p>

<p>Here is the information you need:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Wall: wall.service.com
</span><span class='line'>Pyramus: pyramus.mylove.org:8080
</span><span class='line'>Thisbe: thisbe.mydove.org:5000
</span><span class='line'>
</span><span class='line'>1.1.1.1 wall.service.com
</span><span class='line'>99.9.9.999 pyramus.mylove.org
</span><span class='line'>88.8.8.888 thisbe.mydove.org</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s put Pyramus behind the Wall. We&rsquo;ll need a DNS entry that looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1.1.1.1 pyramus.mylove.org</span></code></pre></td></tr></table></div></figure>


<p>Now, Thisbe sends an HTTP request to Pyramus with the domain name <code>wall.service.com</code> and the host header <code>pyramus.mylove.org:8080</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl 'wall.service.com' -H 'pyramus.mylove.org:8080'</span></code></pre></td></tr></table></div></figure>


<p>The Wall receives the request (because it&rsquo;s at <code>1.1.1.1</code>, the IP address that matches the domain), sees the host header, and passes the request on to Pyramus. Success! (Of course, there will be a response back to Thisbe too, but it&rsquo;s too saccharine to print here.)</p>

<p>Exeunt.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-08-24T07:38:02-07:00" pubdate data-updated="true"></time></div>
	


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2016/08/23/hello-world/">
		
			Hello World</a>
	</h2>
	<div class="entry-content">
		<p>Almost a year and a half ago, on March 2, 2015, I started work as a software engineer. I was new to Portland, new to programming, and frankly, new to having any kind of foreseeable career path.</p>

<p>The first year was a rush: trying to learn as quickly as possible, trying to do well, trying not to fall behind. I set lots of goals for myself. Since I was working on a public REST API, my manager suggested that I learn as much about APIs as possible. Not only did I take that advice, but I started to veer my long-term career goals in the direction of becoming an API master. APIs are neat. They are symbolic of the Internet itself, showing how interconnection enables complexity and creativity. Pursuing that domain-specific knowledge, I focused on having a specialty &ndash; on being special.</p>

<p>From there it was easy to start playing the career ladder game. Can I get a promotion six months from now? What do I have to do to get there? I focused on promotion as a sign I was doing well, a sign that I was on the right track. I felt hugely validated (and, of course, sure that there was some mistake) when I was promoted to Software Engineer II a year in. I couldn&rsquo;t wait to jump right in and start wading towards III, then IV, then senior. I joined a small group of women specifically working on &ldquo;leveling up&rdquo; and kept adding to my list of goals.</p>

<p>Over the last several months, though, I got a wake-up call. Part of the wake-up call was that I changed jobs. The API team (me) was merged into another team, one that owned a bunch of internal services. I stopped driving towards API knowledge and Ruby/Grape expertise and scrambled to pick up Java. Now that I was no longer working full-time on a REST API, my goals around API mastery loosened their grip. When I was asked where I was trying to go long-term, I found that my desire to climb to the level of senior engineer as quickly as possible had also disappeared. Instead, I started wondering: why am I here? What motivates me? And I remembered promises I&rsquo;d made to myself back when I first embarked on the software engineering path. I remembered why I chose a tech career and how it fits into my life goals, not just my career plans.</p>

<p>It&rsquo;s been an interesting process to re-envision my nearer-term goals with respect to these larger life values. I&rsquo;m surprised by what has taken root so strongly: to really pursue work as a full-stack engineer. To be somebody who makes a point of being a generalist. I&rsquo;ve been a generalist all my life. Why switch to being a specialist now? The heck with &ldquo;Jack of all trades, master of none&rdquo; and the associated stigma. I&rsquo;ll be Jack. I like variety. Variety is useful.</p>

<p>I&rsquo;m starting this blog (in earnest this time!) to capture what I learn in the process of becoming a Jack of all trades. If I&rsquo;m going to gobble up knowledge involving React, Angular, Java, Kafka, Rails, Docker, Jenkins, and so much more, then I&rsquo;ll need a place to recompile and condense that information &ndash; and that&rsquo;s here.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-08-23T03:46:40-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/blog/categories/goals/'>goals</a>

</div>


	
</div></article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2016

    Emily Bookstein

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
